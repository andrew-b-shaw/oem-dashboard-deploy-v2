System.register(["jimu-core/react","jimu-arcgis","jimu-ui","esri/layers/FeatureLayer","esri/layers/Layer","esri/Basemap","esri/identity/OAuthInfo","esri/identity/IdentityManager","esri/widgets/LayerList","jimu-ui/basic/color-picker","esri/Color","esri/core/reactiveUtils"],(function(e,t){var a={},r={},i={},s={},o={},n={},l={},d={},c={},p={},m={},u={};return{setters:[function(e){a.Component=e.Component,a.default=e.default},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){i.AdvancedSelect=e.AdvancedSelect,i.Button=e.Button,i.CollapsablePanel=e.CollapsablePanel,i.Dropdown=e.Dropdown,i.DropdownButton=e.DropdownButton,i.DropdownItem=e.DropdownItem,i.DropdownMenu=e.DropdownMenu,i.Icon=e.Icon,i.Loading=e.Loading,i.Modal=e.Modal,i.ModalBody=e.ModalBody,i.ModalFooter=e.ModalFooter,i.ModalHeader=e.ModalHeader,i.Slider=e.Slider,i.Tab=e.Tab,i.Tabs=e.Tabs,i.TextInput=e.TextInput},function(e){s.default=e.default},function(e){o.default=e.default},function(e){n.default=e.default},function(e){l.default=e.default},function(e){d.default=e.default},function(e){c.default=e.default},function(e){p.ColorPicker=e.ColorPicker},function(e){m.default=e.default},function(e){u.default=e.default}],execute:function(){e((()=>{var e={208:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(81),i=a.n(r),s=a(645),o=a.n(s)()(i());o.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:white}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:white}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:#fabe21}.btn-primary:hover{background-color:#fcdd8c}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:white !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#layer-component .layer-tabs{margin-top:10px}#layer-component .layer-tabs__content{height:calc(100% - 139px);width:calc(100% - 16px);overflow-y:auto;position:absolute}#layer-component #layer-search{margin-top:10px}\n",""]);const n=o},824:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(81),i=a.n(r),s=a(645),o=a.n(s)()(i());o.push([e.id,'.jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:white}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:white}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:#fabe21}.btn-primary:hover{background-color:#fcdd8c}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:white !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#layer-list-component .esri-layer-list{height:calc(100vh - 250px);overflow-y:auto;background-color:white}#layer-list-component .esri-layer-list .esri-layer-list__no-items{display:none}#layer-list-component .esri-layer-list .esri-layer-list__item{background-color:white}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container{padding-left:0;animation:new-item 5s ease-out;border:none}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label{position:relative;cursor:move}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-toggle{position:absolute;height:100%}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-toggleLhover{background-color:var(--secondary-100)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-title{margin-left:25px}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-icon-non-visible{color:var(--light-800)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label:has(.esri-icon-non-visible){color:var(--light-800)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-actions-menu-item--active[aria-label="Legend"]{transform:rotate(180deg)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel{margin:0 0 5px 27px;background-color:var(--light)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-layer-list-panel__content{padding:5px 0 5px 10px}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-layer-list-panel__content:has(.legend__templates){border-top:2px var(--light-300) solid}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend{background-color:transparent}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend .esri-legend__service{padding:0}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend .esri-legend__service .esri-legend__layer-child-table{margin:0}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions{background-color:var(--light)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions .esri-layer-list__item-actions-list .esri-disabled-element,#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions .esri-layer-list__item-actions-list .esri-disabled-element:hover{color:var(--light-800);cursor:default}#layer-list-component #layer-list__buttons{display:grid;grid-template-columns:1fr 70px;grid-template-rows:repeat(2, 50%)}#layer-list-component #layer-list__buttons button{padding:3px}#layer-list-component #layer-list__buttons #clear-all-button-grid-item{grid-column:1;grid-row:1;border-bottom:2px var(--light-300) solid}#layer-list-component #layer-list__buttons #clear-all-button-grid-item #clear-all-button{padding-left:0}#layer-list-component #layer-list__buttons #clear-all-button-grid-item #clear-all-button svg{margin-right:0;margin-bottom:2px}#layer-list-component #layer-list__buttons #legend-button-grid-item{grid-column:2;grid-row:1;border-bottom:2px var(--light-300) solid}#layer-list-component #layer-list__buttons #legend-button-grid-item label{font-size:var(--calcite-font-size--1);position:relative;top:4px}#layer-list-component #layer-list__buttons #legend-button-grid-item #legend-button{position:relative;bottom:2px}#layer-list-component #layer-list__buttons #layer-visibility-button-grid-item{grid-column:1;grid-row:2}.color-picker-block{display:inline-block;position:relative;top:11px;left:5px}.layer-size-slider>input{display:inline-block;width:86%;position:relative;top:3px;margin:0 10px}#picture-marker-warning{margin-top:10px}\n',""]);const n=o},986:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(81),i=a.n(r),s=a(645),o=a.n(s)()(i());o.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:white}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:white}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:#fabe21}.btn-primary:hover{background-color:#fcdd8c}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:white !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#template-component #active-templates-menu{height:60px;overflow-x:auto;overflow-y:hidden;white-space:nowrap;padding-top:12px}#template-component #active-templates-menu .scroll-item{width:150px}#template-component #active-templates-menu .nav-link{color:var(--dark-800);background-color:white;border-radius:50rem;text-decoration:none;font-style:normal;cursor:default}#template-component #active-templates-menu .tab-title{margin-top:2px}#template-component #active-templates-menu #no-active-templates{padding-left:5px}#template-component #template-pane{z-index:1;width:100%;position:relative}#template-component #template-pane #template-pane__button{width:100%;text-align:left;padding:0}#template-component #template-pane #template-pane__content{height:calc(100vh - 246px);position:relative;background-color:var(--light);overflow-y:auto}#template-component #template-pane #template-pane__content .template-dropdown__content{margin-left:15px}#template-component #template-pane #template-pane__header>.setting-collapse{border-bottom:1px var(--dark-800) solid}#template-component #template-pane .collapse-label{padding-left:5px}#template-component #template-pane .more-info #template-pane__content .setting-collapse:has(.collapse.show){animation:new-item 5s ease-out}.template-search-item{width:100%}.template-search-item .template-search-item__add-button{width:calc(100% - 55px)}\n",""]);const n=o},459:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(81),i=a.n(r),s=a(645),o=a.n(s)()(i());o.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:white}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:white}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:#fabe21}.btn-primary:hover{background-color:#fcdd8c}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:white !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}\n",""]);const n=o},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",r=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),r&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),r&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a})).join("")},t.i=function(e,a,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var n=0;n<this.length;n++){var l=this[n][0];null!=l&&(o[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);r&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),a&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=a):c[2]=a),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function a(e){for(var a=-1,r=0;r<t.length;r++)if(t[r].identifier===e){a=r;break}return a}function r(e,r){for(var s={},o=[],n=0;n<e.length;n++){var l=e[n],d=r.base?l[0]+r.base:l[0],c=s[d]||0,p="".concat(d," ").concat(c);s[d]=c+1;var m=a(p),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)t[m].references++,t[m].updater(u);else{var h=i(u,r);r.byIndex=n,t.splice(n,0,{identifier:p,updater:h,references:1})}o.push(p)}return o}function i(e,t){var a=t.domAPI(t);return a.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,i){var s=r(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var n=a(s[o]);t[n].references--}for(var l=r(e,i),d=0;d<s.length;d++){var c=a(s[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=l}}},569:e=>{"use strict";var t={};e.exports=function(e,a){var r=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(a)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,a)=>{"use strict";e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var r="";a.supports&&(r+="@supports (".concat(a.supports,") {")),a.media&&(r+="@media ".concat(a.media," {"));var i=void 0!==a.layer;i&&(r+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),r+=a.css,i&&(r+="}"),a.media&&(r+="}"),a.supports&&(r+="}");var s=a.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},673:e=>{"use strict";e.exports=n},639:e=>{"use strict";e.exports=m},135:e=>{"use strict";e.exports=u},380:e=>{"use strict";e.exports=d},263:e=>{"use strict";e.exports=l},818:e=>{"use strict";e.exports=s},195:e=>{"use strict";e.exports=o},447:e=>{"use strict";e.exports=c},826:e=>{"use strict";e.exports=r},315:e=>{"use strict";e.exports=a},726:e=>{"use strict";e.exports=i},362:e=>{"use strict";e.exports=p}},t={};function h(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={id:a,exports:{}};return e[a](i,i.exports,h),i.exports}h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},h.d=(e,t)=>{for(var a in t)h.o(t,a)&&!h.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="",h.nc=void 0;var g={};return h.p=window.jimuConfig.baseUrl,(()=>{"use strict";h.r(g),h.d(g,{__set_webpack_public_path__:()=>ve,default:()=>fe});var e=h(379),t=h.n(e),a=h(795),r=h.n(a),i=h(569),s=h.n(i),o=h(565),n=h.n(o),l=h(216),d=h.n(l),c=h(589),p=h.n(c),m=h(459),u={};u.styleTagTransform=p(),u.setAttributes=n(),u.insert=s().bind(null,"head"),u.domAPI=r(),u.insertStyleElement=d(),t()(m.Z,u),m.Z&&m.Z.locals&&m.Z.locals;var y=h(315),f=h(826),v=h(726),b=h(818),w=h(195),_=h(673),E=function(){return E=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E.apply(this,arguments)},T=function(e,t){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},T(e,t)},k=function(){return k=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},k.apply(this,arguments)};function L(e){return Object.keys(e).some((function(t){var a=e[t];if(!a)return!1;switch(a&&a.toParam&&(a=a.toParam()),a.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}}))}function x(e){var t={};return Object.keys(e).forEach((function(a){var r,i,s=e[a];if(s&&s.toParam&&(s=s.toParam()),s||0===s||"boolean"==typeof s||"string"==typeof s){var o;switch(s.constructor.name){case"Array":var n=null===(i=null===(r=s[0])||void 0===r?void 0:r.constructor)||void 0===i?void 0:i.name;o="Array"===n?s:"Object"===n?JSON.stringify(s):s.join(",");break;case"Object":o=JSON.stringify(s);break;case"Date":o=s.valueOf();break;case"Function":o=null;break;case"Boolean":o=s+"";break;default:o=s}(o||0===o||"string"==typeof o||Array.isArray(o))&&(t[a]=o)}})),t}function C(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map((function(t){return C(e,t)})).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function S(e){var t=x(e);return Object.keys(t).map((function(e){return C(e,t[e])})).join("&")}var O=function(e,t,a,r,i){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=a,this.url=r,this.options=i};O.prototype=Object.create(Error.prototype),O.prototype.constructor=O;var I="@esri/arcgis-rest-js",A={httpMethod:"POST",params:{f:"json"}},M=function(e){function t(t,a,r,i,s){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===a&&(a="AUTHENTICATION_ERROR_CODE");var o=e.call(this,t,a,r,i,s)||this;return o.name="ArcGISAuthError",o.message="AUTHENTICATION_ERROR_CODE"===a?t:a+": "+t,o}return function(e,t){function a(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),t.prototype.retry=function(e,t){var a=this;void 0===t&&(t=3);var r=0,i=function(s,o){e(a.url,a.options).then((function(e){var t=k(k({},a.options),{authentication:e});return r+=1,j(a.url,t)})).then((function(e){s(e)})).catch((function(e){"ArcGISAuthError"===e.name&&r<t?i(s,o):"ArcGISAuthError"===e.name&&r>=t?o(a):o(e)}))};return new Promise((function(e,t){i(e,t)}))},t}(O);function j(e,t){void 0===t&&(t={params:{f:"json"}});var a=k(k(k({httpMethod:"POST"},A),t),{params:k(k({},A.params),t.params),headers:k(k({},A.headers),t.headers)}),r=[],i=[];if(a.fetch||"undefined"==typeof fetch?(r.push("`fetch`"),i.push("`node-fetch`")):a.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(r.push("`Promise`"),i.push("`es6-promise`")),"undefined"==typeof FormData&&(r.push("`FormData`"),i.push("`isomorphic-form-data`")),!a.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+r.join(", ")+". We recommend installing the "+i.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var s=a.httpMethod,o=a.authentication,n=a.rawResponse,l=k({f:"json"},a.params),d=null,c={method:s,credentials:a.credentials||"same-origin"};return a.headers&&a.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(c.credentials="include"),(o?o.getToken(e,{fetch:a.fetch}).catch((function(t){return t.url=e,t.options=a,d=t,Promise.resolve("")})):Promise.resolve("")).then((function(t){t.length&&(l.token=t),o&&o.getDomainCredentials&&(c.credentials=o.getDomainCredentials(e));var r={};if("GET"===c.method){l.token&&a.hideToken&&"undefined"==typeof window&&(r["X-Esri-Authorization"]="Bearer "+l.token,delete l.token);var i=""===S(l)?e:e+"?"+S(l);a.maxUrlLength&&i.length>a.maxUrlLength||l.token&&a.hideToken?(c.method="POST",t.length&&a.hideToken&&(l.token=t,delete r["X-Esri-Authorization"])):e=i}var s=new RegExp("/items/.+/updateResources").test(e);return"POST"===c.method&&(c.body=function(e,t){var a=L(e)||t,r=x(e);if(a){var i=new FormData;return Object.keys(r).forEach((function(e){if("undefined"!=typeof Blob&&r[e]instanceof Blob){var t=r.fileName||r[e].name||e;i.append(e,r[e],t)}else r[e].constructor&&"ReadStream"===r[e].constructor.name&&Number.isInteger(r.dataSize)?i.append(e,r[e],{knownLength:r.dataSize}):i.append(e,r[e])})),i}return S(e)}(l,s)),c.headers=k(k({},r),a.headers),"undefined"!=typeof window||c.headers.referer||(c.headers.referer=I),L(l)||s||(c.headers["Content-Type"]="application/x-www-form-urlencoded"),a.fetch(e,c)})).then((function(t){if(!t.ok){var r=t.status,i=t.statusText;throw new O(i,"HTTP "+r,t,e,a)}if(n)return t;switch(l.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}})).then((function(t){if("json"!==l.f&&"geojson"!==l.f||n)return t;var r=function(e,t,a,r,i){if(e.code>=400){var s=e.message,o=e.code;throw new O(s,o,e,t,r)}if(e.error){var n=e.error,l=(s=n.message,o=n.code,n.messageCode),d=l||o||"UNKNOWN_ERROR_CODE";if(498===o||499===o||"GWM_0003"===l||400===o&&"Unable to generate token."===s)throw i||new M(s,d,e,t,r);throw new O(s,d,e,t,r)}if("failed"===e.status||"failure"===e.status){s=void 0,o="UNKNOWN_ERROR_CODE";try{s=JSON.parse(e.statusMessage).message,o=JSON.parse(e.statusMessage).code}catch(t){s=e.statusMessage||e.message}throw new O(s,o,e,t,r)}return e}(t,e,0,a,d);if(d){var i=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];a.authentication.federatedServers[i]={token:[],expires:new Date(Date.now()+864e5)},d=null}return r}))}function R(e){return j(("string"!=typeof(t=e.url)||"/"===(t=t.trim())[t.length-1]&&(t=t.slice(0,-1)),t+"/addFeatures"),function(e,t,a){var r=k(k({params:{}},a),e);return r.params=["features","gdbVersion","returnEditMoment","rollbackOnFailure"].reduce((function(t,a){return(e[a]||"boolean"==typeof e[a])&&(t[a]=e[a]),t}),r.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce((function(e,t){return r[t]&&(e[t]=r[t]),e}),{})}(e,0,{params:E({},e.params)}));var t}var N=h(263),D=h(380),P=h(208),z={};z.styleTagTransform=p(),z.setAttributes=n(),z.insert=s().bind(null,"head"),z.domAPI=r(),z.insertStyleElement=d(),t()(P.Z,z),P.Z&&P.Z.locals&&P.Z.locals;class B extends y.Component{render(){return y.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddLayer(this.props.layer),size:"sm",type:"tertiary",className:"add-button",disabled:this.props.active},y.default.createElement(v.Icon,{icon:this.props.active?"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/check-32.svg":"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),this.props.layer.title)}}const H=B;class U extends y.Component{render(){return y.default.createElement("div",{id:"layer-search"},y.default.createElement(v.AdvancedSelect,{isMultiple:!0,isEmptyOptionHidden:!0,onChange:function(){},placeholder:"Select layer...",size:"default",sortValuesByLabel:!0,staticValues:this.props.layers.map((e=>({label:e.title,value:e.id,render:t=>y.default.createElement(H,{layer:e,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(e)})})))}))}}const F=U;class V extends y.Component{constructor(){super(...arguments),this.renderCategoryTabs=()=>this.props.categories.map((e=>y.default.createElement(v.Tab,{id:"category-"+e.id+"-tab",className:"tab",title:e.title+" ("+e.layers.length+")"},y.default.createElement("div",{id:"category-"+e.id+"-tab-content",className:"layer-tabs__content p-5 border"},e.layers.map((e=>y.default.createElement(H,{layer:e,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(e)})))))))}render(){return y.default.createElement("div",{id:"layer-component"},y.default.createElement("h3",null,"Layers"),this.props.layers&&y.default.createElement(F,{layers:this.props.layers,onAddLayer:this.props.onAddLayer,activeLayers:this.props.activeLayers}),y.default.createElement("div",{className:"layer-tabs"},y.default.createElement(v.Tabs,{onChange:function(){},onClose:function(){},type:"tabs",scrollable:!0},this.props.categories&&this.renderCategoryTabs())))}}const W=V;class J extends y.Component{constructor(e){super(e),this.toggleOpen=()=>{this.setState({open:!this.state.open})},this.checkValidity=e=>({valid:e.length<=50,msg:"Maximum title length is 50 characters!"}),this.state={title:void 0,open:!1}}render(){return y.default.createElement("div",{id:"save-template-component"},this.props.show&&y.default.createElement(v.Button,{onClick:this.toggleOpen,id:"open-save-template-button",type:"primary"},y.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),"Save As New Template"),y.default.createElement(v.Modal,{isOpen:this.state.open,onClosed:function(){},onEnter:function(){},onExit:function(){},onOpened:function(){},toggle:this.toggleOpen},y.default.createElement(v.ModalHeader,{toggle:this.toggleOpen},"Save As New Template"),y.default.createElement(v.ModalBody,null,"Template Title:",y.default.createElement(v.TextInput,{className:"mb-3",placeholder:"Enter Template Title...",onAcceptValue:e=>this.setState({title:e}),checkValidityOnChange:this.checkValidity,checkValidityOnAccept:this.checkValidity})),y.default.createElement(v.ModalFooter,null,y.default.createElement(v.Button,{onClick:this.toggleOpen},"Cancel"),y.default.createElement(v.Button,{onClick:()=>{this.props.handleClick(this.state.title),this.toggleOpen()},id:"save-template-button",type:"primary"},"Save"))))}}const Z=J;var G=h(824),q={};q.styleTagTransform=p(),q.setAttributes=n(),q.insert=s().bind(null,"head"),q.domAPI=r(),q.insertStyleElement=d(),t()(G.Z,q),G.Z&&G.Z.locals&&G.Z.locals;var Y=h(447),X=h(362),K=h(639);class Q extends y.Component{constructor(e){super(e),this.onOpened=()=>{let e=this.props.layer.renderer.symbol;switch(e.type){case"simple-marker":this.setState({showColorPicker:!0,showSizeSlider:!0,color:e.color.toString(),size:e.size});break;case"picture-marker":this.setState({showColorPicker:!1,showSizeSlider:!0,color:"#ffffff",size:e.width});break;default:this.setState({showColorPicker:!0,showSizeSlider:!1,color:e.color.toString(),size:null})}},this.handleSave=()=>{let e=this.props.layer.renderer;switch(e.symbol.type){case"simple-marker":e.symbol.color=new K.default(this.state.color),e.symbol.size=this.state.size;break;case"picture-marker":let t=e.symbol,a=t.height/t.width;t.width=this.state.size,t.height=this.state.size*a;break;default:e.symbol.color=new K.default(this.state.color)}this.props.onSave()},this.state={showColorPicker:!1,showSizeSlider:!1,color:null,size:null}}render(){return y.default.createElement(v.Modal,{isOpen:this.props.open,onClosed:function(){},onEnter:function(){},onExit:function(){},onOpened:this.onOpened,toggle:this.props.toggleOpen},y.default.createElement(v.ModalHeader,{toggle:this.props.toggleOpen},"Edit Layer Style"),y.default.createElement(v.ModalBody,null,this.state.showSizeSlider&&y.default.createElement("div",{className:"layer-size-slider"},"Size:",y.default.createElement(v.Slider,{"aria-label":"Layer Size Slider",onChange:e=>this.setState({size:+e.target.value}),min:0,max:Math.max(100,this.state.size),value:this.state.size}),y.default.createElement("label",null,this.state.size)),this.state.showColorPicker&&y.default.createElement("div",{className:"layer-color-picker"},"Color:",y.default.createElement(X.ColorPicker,{"aria-label":"Layer Color Picker",color:this.state.color,height:30,width:30,onChange:e=>{this.setState({color:e})},onClick:function(){},placement:"bottom",type:"default"}))),y.default.createElement(v.ModalFooter,null,y.default.createElement(v.Button,{onClick:this.props.toggleOpen},"Cancel"),y.default.createElement(v.Button,{onClick:this.handleSave,id:"save-template-button",type:"primary"},"Save")))}}const $=Q;var ee=h(135);class te extends y.Component{constructor(e){super(e),this.state={legendMenuOpen:!1}}render(){return y.default.createElement("div",{id:"layer-list__buttons"},y.default.createElement("div",{id:"clear-all-button-grid-item"},y.default.createElement(v.Button,{"aria-label":"Button",onClick:this.props.onClearAll,size:"default",id:"clear-all-button",type:"tertiary"},"Clear All")),y.default.createElement("div",{id:"legend-button-grid-item"},y.default.createElement(v.Dropdown,{isOpen:this.state.legendMenuOpen},y.default.createElement("label",null,"Legend"),y.default.createElement(v.DropdownButton,{id:"legend-button",arrow:y.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/hamburger-32.svg"}),type:"tertiary",onClick:()=>this.setState({legendMenuOpen:!this.state.legendMenuOpen}),icon:!0}),y.default.createElement(v.DropdownMenu,{alignment:"end"},y.default.createElement(v.DropdownItem,null,y.default.createElement(v.Button,{"aria-label":"Button",onClick:this.props.onShowLegend,size:"default",id:"show-legend-button",type:"tertiary"},"Show Legend")),y.default.createElement(v.DropdownItem,null,y.default.createElement(v.Button,{"aria-label":"Button",onClick:this.props.onHideLegend,size:"default",id:"hide-legend-button",type:"tertiary"},"Hide Legend"))))),y.default.createElement("div",{id:"layer-visibility-grid-item"},y.default.createElement(v.Button,{id:"layer-visibility-button",type:"tertiary",onClick:()=>{this.props.allLayersHidden?this.props.onShowLayers():this.props.onHideLayers()}},y.default.createElement(v.Icon,{icon:this.props.allLayersHidden?"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/view-hide-32.svg":"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/view-visible-32.svg",size:"l"}),this.props.allLayersHidden?"Show All":"Hide All")))}}const ae=te;class re extends y.Component{constructor(e){super(e),this.myRef=y.default.createRef(),this.onItemClick=e=>{},this.showLegend=()=>{for(let e of this.state.widget.operationalItems)e.panel.open=!0},this.hideLegend=()=>{for(let e of this.state.widget.operationalItems)e.panel.open=!1},this.showLayers=()=>{for(let e of this.state.widget.operationalItems)e.layer.visible=!0},this.hideLayers=()=>{for(let e of this.state.widget.operationalItems)e.layer.visible=!1},this.toggleLayerStyleModal=()=>{this.setState({modalOpen:!this.state.modalOpen})},this.changeStyle=()=>{this.refresh(this.state.selectedItem),this.toggleLayerStyleModal()},this.createLegendDiv=()=>{let e=document.createElement("div");return e.className="legend__header",e.innerHTML="Legend: ",e},this.createTemplatesDiv=e=>{let t=document.createElement("div");t.className="legend__templates";let a=this.props.getLayerTemplates(e,!0);if(0===a.length)return t.innerHTML="Templates: None",t;let r="Templates: ";for(let e of a)r+=" "+e.title+",";return t.innerHTML=r.slice(0,-1),t},this.createCategoryDiv=e=>{let t=document.createElement("div");return t.className="legend__category",t.innerHTML="Category: "+this.props.getLayerCategory(e).title,t},this.refresh=e=>{e.parent?e.panel.content=["legend"]:e.panel.content=[this.createLegendDiv(),"legend",this.createTemplatesDiv(e.layer),this.createCategoryDiv(e.layer)]},this.activeViewChangeHandler=e=>{if(this.state.jmv&&this.state.widget&&this.state.widget.destroy(),e&&(this.setState({jmv:e}),this.myRef.current)){const t=new Y.default({view:e.view,listItemCreatedFunction:e=>{return a=this,r=void 0,s=function*(){let a=e.item;a.panel={className:"esri-icon-down"},this.refresh(a),yield a.layer.when(),a.actionsSections=[[{title:"Remove",className:"esri-icon-minus",id:"remove"}],[{title:"Zoom to",className:"esri-icon-zoom-in-magnifying-glass",id:"zoom"}],[{title:"Edit layer style",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/layers-editable-24.svg",id:"change-style",disabled:!("feature"===a.layer.type&&"simple"===a.layer.renderer.type&&(null!=a.layer.renderer.symbol.color||"picture-marker"===a.layer.renderer.symbol.type))}],[{title:"Send backwards",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/send-backwards-24.svg",id:"send-backwards"},{title:"Bring forward",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/bring-forward-24.svg",id:"bring-forward"},{title:"Send to back",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/send-to-back-24.svg",id:"send-to-back"},{title:"Bring to front",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/bring-to-front-24.svg",id:"bring-to-front"}]],a.addHandles([ee.default.watch((()=>t.selectedItems.includes(a)),(()=>this.onItemClick(a))),ee.default.when((()=>a.panel.open),(()=>a.actionsOpen=!1)),ee.default.when((()=>a.actionsOpen),(()=>a.panel.open=!1))])},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(s.next(e))}catch(e){t(e)}}function n(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(e){e(a)}))).then(o,n)}l((s=s.apply(a,r||[])).next())}));var a,r,i,s},container:this.myRef.current,selectionEnabled:!0,multipleSelectionEnabled:!0});t.on("trigger-action",(t=>{const a=t.action.id,r=t.item.layer;let i=this.state.jmv.view.map.layers.findIndex((e=>e===r));switch(a){case"zoom":e.view.goTo(r.fullExtent);break;case"remove":this.props.onRemoveLayer(r);break;case"change-style":this.setState({modalOpen:!0,selectedItem:t.item});break;case"send-backwards":i>0&&this.state.jmv.view.map.reorder(r,i-1);break;case"bring-forward":i>-1&&i<this.state.jmv.view.map.layers.length&&this.state.jmv.view.map.reorder(r,i+1);break;case"send-to-back":i>-1&&this.state.jmv.view.map.reorder(r,0);break;case"bring-to-front":i>-1&&this.state.jmv.view.map.reorder(r,this.state.jmv.view.map.layers.length-1)}})),t.addHandles(ee.default.watch((()=>t.operationalItems.reduce(((e,t)=>e||t.layer.visible),!1)),(()=>this.setState({allLayersHidden:!t.operationalItems.reduce(((e,t)=>e||t.layer.visible),!1)})))),this.setState({widget:t})}},this.state={jmv:null,widget:null,modalOpen:!1,selectedItem:null,allLayersHidden:!1}}render(){if(this.state.widget)for(let e of this.state.widget.viewModel.operationalItems)this.refresh(e);return y.default.createElement("div",{id:"layer-list-component"},y.default.createElement(f.JimuMapViewComponent,{useMapWidgetId:this.props.useMapWidgetId,onActiveViewChange:this.activeViewChangeHandler}),y.default.createElement("h3",null,"Current Layers ("+this.props.numActiveLayers+")"),this.props.numActiveLayers<=0&&y.default.createElement("em",null,"Get started by adding a template or layer from the left side of the panel"),this.props.numActiveLayers>0&&y.default.createElement(ae,{onClearAll:this.props.onClearAll,onHideLegend:this.hideLegend,onShowLegend:this.showLegend,onShowLayers:this.showLayers,onHideLayers:this.hideLayers,allLayersHidden:this.state.allLayersHidden}),y.default.createElement("div",{id:"layer-list__content",ref:this.myRef}),this.state.selectedItem&&this.state.selectedItem.layer&&"feature"===this.state.selectedItem.layer.type&&"simple"===this.state.selectedItem.layer.renderer.type&&y.default.createElement($,{onSave:this.changeStyle,layer:this.state.selectedItem.layer,open:this.state.modalOpen,toggleOpen:this.toggleLayerStyleModal}))}}const ie=re;var se=h(986),oe={};oe.styleTagTransform=p(),oe.setAttributes=n(),oe.insert=s().bind(null,"head"),oe.domAPI=r(),oe.insertStyleElement=d(),t()(se.Z,oe),se.Z&&se.Z.locals&&se.Z.locals;class ne extends y.Component{render(){return y.default.createElement(v.CollapsablePanel,{label:y.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddTemplate(this.props.template),size:"sm",type:"tertiary",disabled:0===this.props.template.layers.length,className:"add-button"},y.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),this.props.template.title+" ("+this.props.template.layers.length+")"),level:0,type:"default",disabled:0===this.props.template.layers.length,defaultIsOpen:this.props.open,onRequestClose:this.props.toggle,onRequestOpen:this.props.toggle},y.default.createElement("div",{className:"template-dropdown__content"},this.props.template.layers.map(((e,t)=>{let a=this.props.template.layers[this.props.template.layers.length-t-1];return y.default.createElement(H,{layer:a,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(a)})}))))}}const le=ne;class de extends y.Component{render(){return y.default.createElement("div",{id:"template-search"},y.default.createElement(v.AdvancedSelect,{isMultiple:!1,isEmptyOptionHidden:!0,onChange:function(){},placeholder:"Select template...",size:"default",sortValuesByLabel:!0,toggle:this.props.onToggle,staticValues:this.props.templates.map((e=>({label:e.title,value:e.id,render:t=>y.default.createElement("span",{className:"template-search-item"},y.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddTemplate(e),size:"sm",type:"tertiary",className:"template-search-item__add-button add-button",disabled:0===e.layers.length},y.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),e.title+" ("+e.layers.length+")"),y.default.createElement(v.Button,{onClick:()=>this.props.onMoreInfo(e),size:"sm",type:"tertiary",className:"template-search-item__info-button",disabled:0===e.layers.length},y.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/hamburger-32.svg",size:"l"})))})))}))}}const ce=de;class pe extends y.Component{render(){return y.default.createElement("div",{id:"active-templates-menu"},0===this.props.activeTemplates.length&&y.default.createElement("div",{id:"no-active-templates"},y.default.createElement("em",null,"Added templates will appear here")),y.default.createElement(v.Tabs,{scrollable:!0,type:"pills"},this.props.activeTemplates.map((e=>y.default.createElement(v.Tab,{id:""+e.id,title:e.title+" ("+e.layers.length+")",onClose:()=>this.props.removeTemplate(e),closeable:!0})))))}}const me=pe;class ue extends y.Component{constructor(e){super(e),this.togglePaneOpen=()=>{this.setState({paneOpen:!this.state.paneOpen,selectedTemplate:null})},this.moreInfo=e=>{this.setState({paneOpen:!0,selectedTemplate:e})},this.state={paneOpen:!1,selectedTemplate:null}}render(){return y.default.createElement("div",null,y.default.createElement("h3",null,"Templates"),this.props.templates&&y.default.createElement("div",{id:"template-component"},y.default.createElement(ce,{templates:this.props.templates,onAddTemplate:this.props.onAddTemplate,onMoreInfo:this.moreInfo,onToggle:e=>{e&&this.setState({paneOpen:!1})}}),y.default.createElement(me,{activeTemplates:this.props.activeTemplates,removeTemplate:this.props.onRemoveTemplate}),y.default.createElement("div",{id:"template-pane"},y.default.createElement("div",{id:"template-pane__header",className:this.state.selectedTemplate?"more-info":""},y.default.createElement(v.CollapsablePanel,{label:y.default.createElement(v.Button,{onClick:this.togglePaneOpen,id:"template-pane__button",type:"tertiary"},"View All"),level:0,type:"default",onRequestOpen:this.togglePaneOpen,onRequestClose:this.togglePaneOpen,isOpen:this.state.paneOpen},y.default.createElement("div",{id:"template-pane__content",className:"p-5 border"},this.props.templates.map((e=>y.default.createElement(le,{template:e,onAddTemplate:this.props.onAddTemplate,open:this.state.selectedTemplate===e,toggle:()=>this.setState({selectedTemplate:null}),onAddLayer:this.props.onAddLayer,activeLayers:this.props.activeLayers})))))))))}}const he=ue;var ge=function(e,t,a,r){return new(a||(a=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function n(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((r=r.apply(e,t||[])).next())}))};class ye extends y.Component{constructor(e){super(e),this.templateTableUrl="https://services1.arcgis.com/UWYHeuuJISiGmgXx/arcgis/rest/services/OEM_Database_v2/FeatureServer/1",this.layerTableURL="https://services1.arcgis.com/UWYHeuuJISiGmgXx/arcgis/rest/services/OEM_Database_v2/FeatureServer/0",this.categoryTableUrl="https://services1.arcgis.com/UWYHeuuJISiGmgXx/arcgis/rest/services/OEM_Database_v2/FeatureServer/2",this.templateLayerRelationshipsUrl="https://services1.arcgis.com/UWYHeuuJISiGmgXx/arcgis/rest/services/OEM_Database_v2/FeatureServer/3",this.fetchCategories=()=>ge(this,void 0,void 0,(function*(){let e=yield this.categoryTable.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["TITLE"]}),t=new Map,a=!1;for(let r of e.features)try{t.set(r.attributes.OBJECTID,{id:r.attributes.OBJECTID,title:r.attributes.TITLE,layers:[]})}catch(e){console.error(e),a=!0}this.setState({categories:t}),a&&alert("Error loading one or more categories!")})),this.fetchLayers=()=>ge(this,void 0,void 0,(function*(){let e=yield this.layerTable.queryFeatures({where:"1=1",outFields:["OBJECTID","TITLE","URL","SCOPE","CATEGORYID","RENDERER"],orderByFields:["SCOPE","TITLE"]}),t=new Map,a=!1;for(let r of e.features)try{let e=yield w.default.fromArcGISServerUrl(r.attributes.URL);if(e.id=r.attributes.OBJECTID,e.title=r.attributes.SCOPE+" "+r.attributes.TITLE,null!=r.attributes.RENDERER&&"feature"===e.type)try{e.renderer=JSON.parse(r.attributes.RENDERER)}catch(e){console.log("Error loading renderer for layer "+r.attributes.TITLE),console.error(e)}t.set(r.attributes.OBJECTID,{layer:e,category:this.state.categories.get(r.attributes.CATEGORYID),templates:[]}),this.state.categories.get(r.attributes.CATEGORYID).layers.push(e)}catch(e){console.error(e),a=!0}this.setState({layers:t}),a&&alert("Error loading one or more layers!")})),this.fetchTemplates=()=>ge(this,void 0,void 0,(function*(){let e=yield this.templateTable.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["TITLE"]}),t=new Map,a=!1;for(let r of e.features)try{t.set(r.attributes.OBJECTID,{id:r.attributes.OBJECTID,title:r.attributes.TITLE,layers:[]})}catch(e){console.error(e),a=!0}this.setState({templates:t}),a&&alert("Error loading one or more templates!")})),this.fetchTemplateLayers=()=>ge(this,void 0,void 0,(function*(){let e=yield this.templateLayerRelationships.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["OBJECTID"]});for(let t of e.features){let e=this.state.layers.get(t.attributes.LAYERID);if(e){let a=this.state.templates.get(t.attributes.TEMPLATEID);a.layers.push(e.layer),this.state.layers.get(t.attributes.LAYERID).templates.push(a)}}this.setState({templates:this.state.templates,loading:!1})})),this.postTemplate=e=>ge(this,void 0,void 0,(function*(){try{if(e)if((yield this.templateTable.queryFeatureCount({where:"TITLE = '"+e+"'",outFields:["*"]}))>0)alert("Error, a template with this title already exists!");else{let t=yield this.fetchToken(),a=(yield R({url:this.templateTableUrl,features:[{attributes:{TITLE:e}}],params:{token:t}})).addResults[0].objectId;yield this.postTemplateLayers(a,t),yield this.fetchTemplates(),yield this.fetchTemplateLayers(),alert("Successfully saved new template!")}else alert("Error, please enter a title!")}catch(e){console.error(e),alert("Error saving template, please try again!")}})),this.postTemplateLayers=(e,t)=>ge(this,void 0,void 0,(function*(){let a=[],r=this.state.jimuMapView.view.map.allLayers;for(let t of r)this.state.layers.has(+t.id)&&a.push({attributes:{TEMPLATEID:e,LAYERID:t.id}});yield R({url:this.templateLayerRelationshipsUrl,features:a,params:{token:t}})})),this.fetchToken=()=>ge(this,void 0,void 0,(function*(){const e=new N.default({appId:"eS2vUdIZbHaVOrDz",flowType:"auto",popup:!1});D.default.registerOAuthInfos([e]);let t=yield D.default.checkSignInStatus(e.portalUrl+"/sharing");return t||(t=yield D.default.getCredential(e.portalUrl+"/sharing")),t.token})),this.addActiveLayer=e=>{if(!this.state.activeLayers.includes(e)){let t=this.state.activeLayers.slice();t.push(e),e.visible=!0,this.state.jimuMapView.view.map.add(e),this.setState({activeLayers:t})}},this.addActiveTemplate=e=>{if(!this.state.activeTemplates.includes(e)){let t=this.state.activeTemplates.slice(),a=this.state.activeLayers.slice();t.push(e);for(let t of e.layers)a.includes(t)||(a.push(t),t.visible=!0,this.state.jimuMapView.view.map.add(t));this.setState({activeTemplates:t,activeLayers:a})}},this.removeActiveLayer=e=>{let t=this.state.activeLayers.filter((t=>t!==e)),a=this.state.activeTemplates;this.state.jimuMapView.view.map.remove(e);for(let r of a)this.state.layers.get(+e.id).templates.includes(r)&&!this.isActive(r,t)&&(a=a.filter((e=>e!==r)));this.setState({activeTemplates:a,activeLayers:t})},this.removeActiveTemplate=e=>{let t=this.state.activeLayers.slice(),a=this.state.activeTemplates.filter((t=>t!==e));for(let r of e.layers){let e=!1;for(let t of a)if(this.state.layers.get(+r.id).templates.includes(t)){e=!0;break}e||(t=t.filter((e=>e!==r)),this.state.jimuMapView.view.map.remove(r))}this.setState({activeTemplates:a,activeLayers:t})},this.isActive=(e,t)=>{for(let a of e.layers)if(t.includes(a))return!0;return!1},this.handleClearAll=()=>{this.state.jimuMapView.view.map.removeAll(),this.setState({activeTemplates:[],activeLayers:[]})},this.getLayerTemplates=(e,t)=>{if(!this.state.layers.get(+e.id))return[];if(t){let t=[];for(let a of this.state.layers.get(+e.id).templates)this.state.activeTemplates.includes(a)&&t.push(a);return t}return this.state.layers.get(+e.id).templates},this.getLayerCategory=e=>this.state.layers.get(+e.id)?this.state.layers.get(+e.id).category:null,this.activeViewChangeHandler=e=>{e&&(this.state.jimuMapView||(e.view.map.basemap=_.default.fromId("arcgis-topographic")),this.setState({jimuMapView:e}))},this.state={jimuMapView:void 0,layers:new Map,templates:new Map,categories:new Map,loading:!0,activeTemplates:[],activeLayers:[]}}componentDidMount(){return ge(this,void 0,void 0,(function*(){try{this.templateTable=new b.default({url:this.templateTableUrl}),this.layerTable=new b.default({url:this.layerTableURL}),this.categoryTable=new b.default({url:this.categoryTableUrl}),this.templateLayerRelationships=new b.default({url:this.templateLayerRelationshipsUrl})}catch(e){return console.error(e),void alert("Error connecting to database, please try again!")}try{yield this.fetchCategories()}catch(e){return console.error(e),void alert("Error loading categories, please try again!")}try{yield this.fetchTemplates()}catch(e){return console.error(e),void alert("Error loading templates, please try again!")}try{yield this.fetchLayers()}catch(e){return console.error(e),void alert("Error loading layers, please try again!")}try{yield this.fetchTemplateLayers()}catch(e){return console.error(e),void alert("Error loading template layers, please try again!")}}))}render(){var e,t;return y.default.createElement("div",{className:"widget-starter jimu-widget"},this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&y.default.createElement(f.JimuMapViewComponent,{useMapWidgetId:null===(e=this.props.useMapWidgetIds)||void 0===e?void 0:e[0],onActiveViewChange:this.activeViewChangeHandler}),y.default.createElement("div",{id:"oem-dashboard-grid"},y.default.createElement("div",{id:"template-component__grid-item",className:"grid-item"},this.state.jimuMapView&&y.default.createElement(he,{templates:Array.from(this.state.templates.values()),activeTemplates:this.state.activeTemplates,onAddTemplate:this.addActiveTemplate,onRemoveTemplate:this.removeActiveTemplate,activeLayers:this.state.activeLayers,onAddLayer:this.addActiveLayer})),y.default.createElement("div",{id:"layer-component__grid-item",className:"grid-item"},this.state.loading&&y.default.createElement(v.Loading,{type:"SECONDARY"}),this.state.jimuMapView&&y.default.createElement(W,{layers:Array.from(this.state.layers.values()).map((e=>e.layer)),categories:Array.from(this.state.categories.values()),activeLayers:this.state.activeLayers,onAddLayer:this.addActiveLayer})),y.default.createElement("div",{id:"layer-list__grid-item",className:"grid-item"},!(this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length)&&y.default.createElement(v.Loading,{type:"SECONDARY"}),this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&y.default.createElement(ie,{useMapWidgetId:null===(t=this.props.useMapWidgetIds)||void 0===t?void 0:t[0],onClearAll:this.handleClearAll,onRemoveLayer:this.removeActiveLayer,getLayerTemplates:this.getLayerTemplates,getLayerCategory:this.getLayerCategory,numActiveLayers:this.state.activeLayers.length})),y.default.createElement("div",{id:"save-template-grid-item",className:"grid-item"},y.default.createElement(Z,{handleClick:this.postTemplate,show:this.state.activeLayers.length>0}))))}}const fe=ye;function ve(e){h.p=e}})(),g})())}}}));